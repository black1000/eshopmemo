<div class="max-w-4xl mx-auto px-4 py-6">
  <h1 class="text-2xl font-bold mb-6 text-gray-800">
    <%= t('items.edit.title')%>
  </h1>

  <%= form_with model: @item, id: "edit-item-form", local: true, class: "bg-gray-50 p-6 rounded-lg shadow grid grid-cols-1 md:grid-cols-2 gap-6" do |f| %>
    <div class="flex flex-col items-center justify-center bg-gray-100 rounded-lg p-4">
      <% if @item.image.attached? %>
        <%= image_tag @item.image, class: "w-48 h-48 object-cover rounded mb-4" %>
      <% else %>
        <div class="w-48 h-48 flex items-center justify-center bg-gray-200 rounded mb-4 text-gray-500">
          <%= t('items.edit.image')%>
        </div>
      <% end %>
      <%= f.file_field :image, accept: "image/*",
            class: "text-sm text-gray-700 cursor-pointer" %>
    </div>

    <div class="space-y-4">
      <div>
        <%= f.label :title, t('items.edit.item_title'), class: "block text-sm font-medium text-gray-700 mb-1" %>
        <%= f.text_field :title, class: "w-full border-gray-300 rounded-md shadow-sm" %>
      </div>

      <div>
  <%= f.label :url, "URL", class: "block text-sm font-medium text-gray-700 mb-1" %>

  <div class="flex items-center">
    <%= f.text_field :url,
      id: "url-input",
      class: "flex-grow border-gray-300 rounded-l-md shadow-sm px-3 py-2 text-sm focus:ring-2 focus:ring-blue-300",
      placeholder: "https://example.com/product" %>

    <button type="button"
      id="clear-url"
      class="bg-gray-100 border border-gray-300 rounded-r-md px-3 py-2 text-sm text-gray-600 hover:bg-gray-200 hover:text-gray-800 transition">
      <%= t('items.edit.clear')%>
    </button>
  </div>

  <p class="text-xs text-gray-500 mt-1">
    <%= t('items.edit.url_change')%>
</div>

<script>
  document.addEventListener("turbo:load", () => {
    const input = document.getElementById("url-input");
    const clearBtn = document.getElementById("clear-url");

    if (input && clearBtn) {
      clearBtn.addEventListener("click", () => {
        input.value = "";
        input.focus();
      });
    }
  });
</script>


      <div>
        <%= f.label :memo, t('items.new.memo'), class: "block text-sm font-medium text-gray-700 mb-1" %>
        <%= f.text_area :memo,
                         rows: 3,
                         maxlength: 30,
                         class: "w-full border-gray-300 rounded-md shadow-sm",
                         placeholder: t('items.edit.memo') %>
      </div>

      <div>
        <%= f.label :tag_id, t('items.edit.tag'), class: "block text-sm font-medium text-gray-700 mb-1" %>
        <%= f.collection_select :tag_id,
              current_user.tags, :id, :name,
              { include_blank: t('items.edit.no_tag') },
              class: "w-full border-gray-300 rounded-md shadow-sm" %>
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">
          <%= t('items.edit.new_tag') %>
        </label>

          <%= f.text_field :tag_name, id: "item_tag_name",
            class: "w-full border-gray-300 rounded-md shadow-sm",
            placeholder: t('items.edit.new_tag_title') %>
              
              <p class="text-xs text-gray-500 mt-1">
                <%= t('items.edit.tag_text') %>
              </p>
      </div>

<%= f.fields_for :reminder do |r| %>
  <%= r.hidden_field :id %>

  <div class="mb-4">
    <%= r.label :scheduled_date, t('items.edit.reminder') %>
    <%= r.date_field :scheduled_date,
    class: "border-2 border-yellow-300 rounded-mb px-3 py-2 focus:outline-none focus:ring-2 focus:ring-yellow-500 focus:border-yellow-500 w-full" %>
  </div>

<% end %>

      <div class="flex justify-between items-center pt-4">
        <%= link_to t('items.edit.back_memo'), items_path,
          class: "px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600" %>

        <%= f.submit t('items.edit.submit'),
          class: "px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700" %>
      </div>
    </div>
  <% end %>
</div>
